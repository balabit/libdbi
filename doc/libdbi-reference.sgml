<!--
$Id$
Copyright (C) 2001, David Parker, Neon Goat Productions.
This document is licensed under the GNU Free Documentation License, version 1.1 or later, as
published by the Free Software Foundation.
-->
<Chapter id="reference"><Title>Libdbi API Reference</Title>
	<Section id="reference-infra"><Title>Plugin Infrastructure</Title>
		 <Section id="dbi-initialize"><Title>dbi_initialize</Title>
			 <Para><ProgramListing>int dbi_initialize(const char *plugindir)</ProgramListing></Para>
			 <Para>Locates all available shared modules (plugins) and loads them into memory.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugindir</Literal>: The directory to search for plugins. If NULL, DBI_PLUGIN_DIR will be used instead.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>The number of plugins successfully loaded, or -1 if there was an error.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-list-plugins"><Title>dbi_list_plugins</Title>
			 <Para><ProgramListing>dbi_plugin_t *dbi_list_plugins()</ProgramListing></Para>
			 <Para>Allows the program to traverse the linked list of plugins, querying the name of each one.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A pointer to the first plugin, or NULL if none were found. The last item in the list will point to a NULL.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-open-plugin"><Title>dbi_open_plugin</Title>
			 <Para><ProgramListing>dbi_plugin_t *dbi_open_plugin(const char *name)</ProgramListing></Para>
			 <Para>Goes through the linked list until it finds the correct plugin.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>name</Literal>: The short name of the desired plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A pointer to the target plugin. NULL if plugin is not found.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-load-driver"><Title>dbi_load_driver</Title>
			 <Para><ProgramListing>dbi_driver_t *dbi_load_driver(const char *name)</ProgramListing></Para>
			 <Para>Creates an actual driver instance from the plugin. This is just a shortcut for calling dbi_open_plugin() and then dbi_start_driver().</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>name</Literal>: The short name of the desired plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>An initialized driver instance, ready to be filled with options and connected. NULL on failure.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-start-driver"><Title>dbi_start_driver</Title>
			 <Para><ProgramListing>dbi_driver_t *dbi_start_driver(const dbi_plugin_t *plugin)</ProgramListing></Para>
			 <Para>Creates an actual driver instance from the plugin.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: A pointer to the plugin to instantiate.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>An initialized driver instance, ready to be filled with options and connected. NULL on failure.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-set-option"><Title>dbi_set_option</Title>
			 <Para><ProgramListing>void dbi_set_option(dbi_driver_t *driver, const char *key, char *value)</ProgramListing></Para>
			 <Para>Sets the specified driver option to a string value. If the value is set to NULL, the entire option entry will be erased.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
						 <Para><Literal>key</Literal>: The name of the target setting. Must only contain [A-Za-z1-9] and _.</Para>
						 <Para><Literal>value</Literal>: The string value of the target setting.</Para>
					 </ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-set-option-numeric"><Title>dbi_set_option_numeric</Title>
			 <Para><ProgramListing>void dbi_set_option_numeric(dbi_driver_t *driver, const char *key, int value)</ProgramListing></Para>
			 <Para>Sets the specified driver option to a numeric value.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
						 <Para><Literal>key</Literal>: The name of the target setting. Must only contain [A-Za-z1-9] and _.</Para>
						 <Para><Literal>value</Literal>: The numeric value of the target setting.</Para>
					 </ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-clear-options"><Title>dbi_clear_options</Title>
			 <Para><ProgramListing>void dbi_clear_options(dbi_driver_t *driver)</ProgramListing></Para>
			 <Para>Clears the entire list of options for the specified driver.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
					 </ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-custom-function"><Title>dbi_custom_function</Title>
			 <Para><ProgramListing>void *dbi_custom_function(dbi_plugin_t *plugin, const char *name)</ProgramListing></Para>
			 <Para>Returns a function pointer to the specifed custom function. This can be used to access database-specific functionality, but its syntax is not elegant and will restrict your code to one particular database, lessening the benefits of using libdbi.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
						 <Para><Literal>name</Literal>: The name of the custom function.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>If the custom function is found, a pointer to that function. If not, returns NULL.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-is-reserved-word"><Title>dbi_is_reserved_word</Title>
			 <Para><ProgramListing>int dbi_is_reserved_word(dbi_plugin_t *plugin, const char *word)</ProgramListing></Para>
			 <Para>Looks for the specified word in the list of reserved words. The result of this function may vary between databases. Case does not matter.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
						 <Para><Literal>word</Literal>: The word to check against the reserved word list.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>-1 if an error occurs, 0 if the word is not reserved, 1 otherwise.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-close-driver"><Title>dbi_close_driver</Title>
			 <Para><ProgramListing>void dbi_close_driver(dbi_driver_t *driver)</ProgramListing></Para>
			 <Para>Disconnects the specified driver connection from the database and cleans up the driver session.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
					 </ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-shutdown"><Title>dbi_shutdown</Title>
			 <Para><ProgramListing>void dbi_shutdown()</ProgramListing></Para>
			 <Para>Frees all loaded plugins and terminates the DBI system. You should close each driver before shutting down, or else shit will fly.</Para>
		 </Section>
	 </Section>
	 <Section id="reference-infra-info"><Title>Plugin Information</Title>
		 <Section id="dbi-plugin-name"><Title>dbi_plugin_name</Title>
			 <Para><ProgramListing>const char *dbi_plugin_name(dbi_plugin_t *plugin)</ProgramListing></Para>
			 <Para>Requests the name of the specified plugin. The calling program must not attempt to free the returned string.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A string containing the plugin's name.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-plugin-filename"><Title>dbi_plugin_filename</Title>
			 <Para><ProgramListing>const char *dbi_plugin_filename(dbi_plugin_t *plugin)</ProgramListing></Para>
			 <Para>Requests the filename of the specified plugin. The calling program must not attempt to free the returned string.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A string containing the plugin's full path and file name.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-plugin-description"><Title>dbi_plugin_description</Title>
			 <Para><ProgramListing>const char *dbi_plugin_description(dbi_plugin_t *plugin)</ProgramListing></Para>
			 <Para>Requests a description of the specified plugin. The calling program must not attempt to free the returned string.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A string containing the plugin's description. It will be one or two short sentences with no newlines.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-plugin-maintainer"><Title>dbi_plugin_maintainer</Title>
			 <Para><ProgramListing>const char *dbi_plugin_maintainer(dbi_plugin_t *plugin)</ProgramListing></Para>
			 <Para>Requests the maintainer of the specified plugin. The calling program must not attempt to free the returned string.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A string containing the plugin maintainer's full name and email address.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-plugin-url"><Title>dbi_plugin_url</Title>
			 <Para><ProgramListing>const char *dbi_plugin_url(dbi_plugin_t *plugin)</ProgramListing></Para>
			 <Para>Requests the maintainer's URL for the specified plugin. This is useful for plugins maintained by a third party. The calling program must not attempt to free the returned string.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A string containing the plugin's URL.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-plugin-version"><Title>dbi_plugin_version</Title>
			 <Para><ProgramListing>const char *dbi_plugin_version(dbi_plugin_t *plugin)</ProgramListing></Para>
			 <Para>Requests the version of the specified plugin. The calling program must not attempt to free the returned string.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A string containing the plugin's version.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-plugin-date-compiled"><Title>dbi_plugin_date_compiled</Title>
			 <Para><ProgramListing>const char *dbi_plugin_date_compiled(dbi_plugin_t *plugin)</ProgramListing></Para>
			 <Para>Requests the compilation date of the specified plugin. The calling program must not attempt to free the returned string.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Arguments</Emphasis></Term>
					 <ListItem>
						 <Para><Literal>plugin</Literal>: The target plugin.</Para>
					 </ListItem>
				 </VarListEntry>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A string containing the date the plugin was compiled.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
		 <Section id="dbi-version"><Title>dbi_version</Title>
			 <Para><ProgramListing>const char *dbi_version()</ProgramListing></Para>
			 <Para>Requests the version of libdbi. The calling program must not attempt to free the returned string.</Para>
			 <VariableList>
				 <VarListEntry>
					 <Term><Emphasis>Returns</Emphasis></Term>
					 <ListItem><Para>A string containing the library's name and version.</Para></ListItem>
				 </VarListEntry>
			 </VariableList>
		 </Section>
	</Section>
	<Section id="reference-database"><Title>SQL and Database Layer</Title>
		<Section id="dbi-connect"><Title>dbi_connect</Title>
			<Para><ProgramListing>int dbi_connect(dbi_driver_t *driver)</ProgramListing></Para>
			<Para>Connects to the database using the options (host, username, password, port, (etc.) set with dbi_set_option() and dbi_set_option_numeric(). See the documentation for each specific database plugin for the options it recognizes and requires.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>-1 on failure, zero on success.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-fetch-field"><Title>dbi_fetch_field</Title>
			<Para><ProgramListing>int dbi_fetch_field(dbi_result_t *result, const char *key, void *to)</ProgramListing></Para>
			<Para>Retrieves the value of the specified field and stores it in the "to" variable. libdbi detects the type of each field (INT, VARCHAR, etc), and will convert the retrieved value into the correct type. The programmer must make sure that the destination variable is also of the correct type, or else weird things will happen. See the documentation for each specific database plugin for the SQL datatypes it recognizes and the equivalent variable types in C.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>result</Literal>: The result handle from a successful SELECT query.</Para>
						<Para><Literal>key</Literal>: The name of the column to retrieve the value from.</Para>
						<Para><Literal>to</Literal>: A pointer to the destination variable of the field's value.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>-1 on failure, zero on success.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-fetch-field-raw"><Title>dbi_fetch_field_raw</Title>
			<Para><ProgramListing>int dbi_fetch_field_raw(dbi_result_t *result, const char *key, void *to)</ProgramListing></Para>
			<Para>Retrieves the value of the specified field and stores it in the "to" variable. libdbi will store the value as whatever type the database provided, which will vary between databases. The programmer must make sure that the destination variable is of the same type that the database expects, or else weird things will happen. See the documentation for each specific database plugin for the SQL datatypes it recognizes and the equivalent variable types in C.</Para>
			<Para>[NOTE: THIS FUNCTION MAY BE REMOVED]</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>result</Literal>: The result handle from a successful SELECT query.</Para>
						<Para><Literal>key</Literal>: The name of the column to retrieve the value from.</Para>
						<Para><Literal>to</Literal>: A pointer to the destination variable of the field's value.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>-1 on failure, zero on success.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-fetch-row"><Title>dbi_fetch_row</Title>
			<Para><ProgramListing>int dbi_fetch_row(dbi_result_t *result)</ProgramListing></Para>
			<Para>Retrieves the next row in the result set. With most queries, this will simply increase a memory pointer where all the results are stored. However, if the query was executed with dbi_efficient_query(), this function will actually retrive the next row from the database server, minimizing the memory used by libdbi.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>result</Literal>: The result handle from a successful SELECT query.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>-1 if there was an error, zero if no more rows are available, or 1 if the next row was successfully retrieved.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-free-query"><Title>dbi_free_query</Title>
			<Para><ProgramListing>int dbi_free_query(dbi_result_t *result)</ProgramListing></Para>
			<Para>Ends the query associated with the specified result handle and cleans up any temporary variables. In databases that require it (such as mysql), any unread rows in a result set will be read and then discarded so that the query can be safely freed.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>result</Literal>: The result handle from a successful SELECT query.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>-1 on failure, zero on success.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-goto-row"><Title>dbi_goto_row</Title>
			<Para><ProgramListing>int dbi_goto_row(dbi_result_t *result, unsigned int row)</ProgramListing></Para>
			<Para>Jumps to a specific row in a result set.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>result</Literal>: The result handle from a successful SELECT query.</Para>
						<Para><Literal>row</Literal>: The offset of the row to seek to. The offset is zero based.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>-1 on failure or if the offset is invalid, zero on success.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-list-dbs"><Title>dbi_list_dbs</Title>
			<Para><ProgramListing>const char **dbi_list_dbs(dbi_driver_t *driver)</ProgramListing></Para>
			<Para>Requests a list of the available databases on the server. The calling program must free the returned array and each individual string.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>An array of strings in no particular order.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-list-tables"><Title>dbi_list_tables</Title>
			<Para><ProgramListing>const char **dbi_list_tables(dbi_driver_t *driver, const char *db)</ProgramListing></Para>
			<Para>Requests a list of the available tables in a particular database. The calling program must free the returned array and each individual string.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
						<Para><Literal>db</Literal>: The name of the database to look in.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>An array of strings in no particular order.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-num-rows"><Title>dbi_num_rows</Title>
			<Para><ProgramListing>unsigned int dbi_num_rows(dbi_result_t *result)</ProgramListing></Para>
			<Para>Returns the number of rows in the specified result set.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>result</Literal>: The result handle from a successful SELECT query.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>The number of rows in the result set.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-num-rows-affected"><Title>dbi_num_rows_affected</Title>
			<Para><ProgramListing>unsigned int dbi_num_rows_affected(dbi_result_t *result)</ProgramListing></Para>
			<Para>Returns the number of rows in the specified result set that were actually modified. Not all database servers support this, so it may always be zero. See the documentation for each specific plugin for details.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>result</Literal>: The result handle from a successful SELECT query.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>The number of modified rows in the result set.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-query"><Title>dbi_query</Title>
			<Para><ProgramListing>dbi_result_t *dbi_query(dbi_driver_t *driver, const char *formatstr, ...)</ProgramListing></Para>
			<Para>Executes the specified SQL query statement.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
						<Para><Literal>formatstr</Literal>: The format string for the SQL statement. It uses the same format as printf().</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>A handle to a result set if successful, NULL if not.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-efficient-query"><Title>dbi_efficient_query</Title>
			<Para><ProgramListing>dbi_result_t *dbi_efficient_query(dbi_driver_t *driver, const char *formatstr, ...)</ProgramListing></Para>
			<Para>Executes the specified SQL query statement in an efficient manner, retrieving only one row of results at a time. This uses less memory, but has the downside that other queries can't be made until this one is closed (in some database servers - see the specific plugin documentation).</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
						<Para><Literal>formatstr</Literal>: The format string for the SQL statement. It uses the same format as printf().</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>A handle to a result set if successful, NULL if not.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="dbi-select-db"><Title>dbi_select_db</Title>
			<Para><ProgramListing>int dbi_select_db(dbi_driver_t *driver, const char *db)</ProgramListing></Para>
			<Para>Switches to a different database on the server.</Para>
			<VariableList>
				<VarListEntry>
					<Term><Emphasis>Arguments</Emphasis></Term>
					<ListItem>
						<Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
						<Para><Literal>db</Literal>: The name of the database to switch to.</Para>
					</ListItem>
				</VarListEntry>
				<VarListEntry>
					<Term><Emphasis>Returns</Emphasis></Term>
					<ListItem><Para>-1 on failure, zero on success.</Para></ListItem>
				</VarListEntry>
			</VariableList>
		</Section>
		<Section id="reference-database-error"><Title>Database Error Handling</Title>
			<Section id="dbi-error"><Title>dbi_error</Title>
				<Para><ProgramListing>int *dbi_error(dbi_driver_t *driver, char *errmsg_dest)</ProgramListing></Para>
				<Para>Generates a formatted message with the error number and description resulting from the previous database operation, copying the message into the specified string.</Para>
				<VariableList>
					<VarListEntry>
						<Term><Emphasis>Arguments</Emphasis></Term>
						<ListItem>
							<Para><Literal>driver</Literal>: The initialized driver obtained from dbi_load_driver() or dbi_start_driver().</Para>
							<Para><Literal>errmsg_dest</Literal>: The target string variable to copy the error message into. If NULL, no error message will be created, but the error number will still be returned.</Para>
						</ListItem>
					</VarListEntry>
					<VarListEntry>
						<Term><Emphasis>Returns</Emphasis></Term>
						<ListItem><Para>The error number of the most recent database operation if it resulted in an error. If not, this will return -1.</Para></ListItem>
					</VarListEntry>
				</VariableList>
			</Section>
			<Section id="dbi-error-handler"><Title>dbi_error_handler</Title>
				<Para><ProgramListing>void dbi_error_handler(dbi_driver_t *driver, void *function, void *user_argument)</ProgramListing></Para>
				<Para>Registers an error handler callback to be triggered whenever the database encounters an error. The callback function should perform as little work as possible, since the state in which it is called can be uncertain. The actual function declaration must accept two parameters:</Para>
				<ItemizedList>
					<ListItem><Para><Literal>dbi_driver_t *driver</Literal>: a pointer to the driver that triggered the error, from which dbi_error() can be called, and</Para></ListItem>
					<ListItem><Para><Literal>void *user_argument</Literal>: a pointer to whatever data (if any) was registered along with the handler.</Para></ListItem>
				</ItemizedList>
				<Para>To remove the error handler callback, specify NULL as the function and user_argument.</Para>
				<VariableList>
					<VarListEntry>
						<Term><Emphasis>Arguments</Emphasis></Term>
						<ListItem>
							<Para><Literal>function</Literal>: A pointer to the function to call when the error handler should be triggered.</Para>
							<Para><Literal>user_argument</Literal>: Any data to pass along to the function when it is triggered. Set to NULL if unused.</Para>
						</ListItem>
					</VarListEntry>
				</VariableList>
			</Section>
		</Section>
	</Section>
</Chapter>
